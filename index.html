<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- AOS link -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">

    <!-- CSS link -->
     <!-- <link rel="stylesheet" href="style.css"> -->

     <!-- TailwindCSS link -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Daisy ui -->
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>

     <!-- Font Awesome -->
    <script src="https://kit.fontawesome.com/57836aaf8e.js" crossorigin="anonymous"></script>


    <title>Devspare</title>

</head>


<body>
    
    <div  class="container mx-auto my-[50px]">
        <!-- Header Section -->
        <section id="header">
        
            <!-- Navbar Section -->
            <nav>
                <div class="navbar bg-base-100">
                    <div class="navbar-start">
                        <div class="dropdown">
                            <div tabindex="0" role="button" class="btn btn-ghost lg:hidden">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24"
                                    stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                        d="M4 6h16M4 12h8m-8 6h16" />
                                </svg>
                            </div>
                            <ul tabindex="0"
                                class="menu menu-sm dropdown-content bg-base-100 rounded-box z-[1] mt-3 w-52 p-2 shadow">
                                <li><a href="#"><i class="fa-regular fa-user text-[25px]"></i></a></li>
                                <li><a href="#"><span class="lg:text-[25px] text-[18px]">Post</span><i
                                            class="fa-regular fa-pen-to-square lg:text-[25px] text-[18px]"></i></a></li>
                                <li><a href="#"><i class="fa-regular fa-bell lg:text-[25px] text-[18px] "></i></a></li>
                            </ul>
                        </div>
                        <button class=" hover:bg-gray-200 border px-[20px] rounded-2xl  text-[55px] font-bold text-blue-600"><a
                                href="/index.html">Devspare!</a></button>
                    </div>
                    <!-- <div class="navbar-center hidden lg:flex">
                        <ul class="menu menu-horizontal px-1">
                            <li><a href="#"><i class="fa-regular fa-user text-[25px]"></i></a></li>
                            <li><a href="#"><span class="text-[25px]">Post</span><i
                                        class="fa-regular fa-pen-to-square text-[25px]"></i></a></li>
                            <li><a href="#"><i class="fa-regular fa-bell text-[25px]"></i></a></li>
        
                        </ul>
                    </div> -->
                    <div class="form-control  w-full">
                        <input type="text" placeholder="Search" class="input input-bordered   w-[450px]" />
                    </div>

                    <div class="navbar-end flex gap-2">
                        <div class="flex gap-2">
                            <!-- <div class="form-control">
                                <input type="text" placeholder="Search" class="input input-bordered w-24 md:w-auto" />
                            </div> -->
                            <div class="navbar-center hidden lg:flex">
                                <ul class="menu menu-horizontal px-1">
                                    <li><a href="#"><i class="fa-regular fa-user text-[25px]"></i></a></li>

                                    <!-- Post -->
                                    <li><a href="/post.html"><span class="text-[25px]">Post</span><i class="fa-regular fa-pen-to-square text-[25px]"></i></a>
                                    </li>

                                    

                                    <li>
                                        <div class="flex gap-[8px] items-center text-[18px]">
                                        
                                            <!-- Comment Icon -->
                                            <div>
                                                <!-- Test start -->
                                                <!-- You can open the modal using ID.showModal() method -->
                                        



                                                
                                                <div class="fa-regular fa-bell text-[25px] " onclick="my_modal_4.showModal()"></div>

                                                <dialog id="my_modal_4" class="modal ">
                                                    <div class="modal-box w-[700px] max-w-5xl ">
                                                        <h3 class="text-[34px] lg:mb-[20px] text-black font-semibold">Notification <span></span></h3>
                                        
                                        
                                                       
                                        <div id="notificationCon"></div>
                                        
                                        
                                                        <div class="modal-action">
                                                            <form method="dialog">
                                                                <!-- if there is a button, it will close the modal -->
                                                                <button class="btn">Close</button>
                                                            </form>
                                                        </div>
                                                    </div>
                                                </dialog>
                                                <!-- Test end -->
                                        
                                            </div>
                                            <p id="tNotification"> 00000</p>
                                        
                                        </div>
                                    </li>
                            
                                </ul>
                            </div>
                            <div class="dropdown dropdown-end">
                                <div tabindex="0" role="button" class="btn btn-ghost btn-circle avatar">
                                    <div class="w-10 rounded-full">
                                        <img id="profile-avatar" alt="Tailwind CSS Navbar component"
                                            src="" />
                                    </div>
                                </div>
                                <ul tabindex="0"
                                    class="menu menu-sm dropdown-content bg-base-100 rounded-box z-[1] mt-3 w-52 p-2 shadow">
                                    <li>
                                        <a class="justify-between">
                                            Profile
        
                                        </a>
                                    </li>

                                    
                                    <li><a>Dashboard</a></li>
                                    <li><a href="/logout.html" onclick="removeToken()">Logout</a></li>
                                    
                                    
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
        
        
            </nav>
        
    
            <!-- <div class="divider"></div> -->
        
            <!-- Header Section -->
            <!-- <div class="subHeader lg:max-w-[1100px] max-w-[300px] mx-auto">
                <h1 class="lg:text-[27px] text-[20px]">Following</h1>
            </div> -->
        
            
            <div class="divider"></div>
        
        </section>
        
        
        <!-- Content Section -->
        <section id="content" class=" lg:max-w-[1100px] w-full mx-auto mt-[20px]" >
        
            <!-- Card - 01 -->
            <a href="/cardDetails.html">
                <div id="postsContainer"></div>
            </a>
        
        </section>

    </div>

     <!-- Footer Section -->
     <section>
        <footer class="footer bg-base-200 text-base-content p-10">

            <nav>
                <h6 class="footer-title">Company</h6>
                <a href="/branding.html" class="link link-hover">Branding</a>
                <a href="/aboutus.html" class="link link-hover">About us</a>
                <a href="/contact.html" class="link link-hover">Contact</a>
                <a href="/jobs.html" class="link link-hover">Jobs</a>
                <a href="/" class="link link-hover">Press kit</a>
            </nav>
            <nav>
                <h6 class="footer-title">Legal</h6>
                <a  href="/terms.html" class="link link-hover">Terms of use</a>
                <a href="/privacy.html" class="link link-hover">Privacy policy</a>
                <a href="/cookie.html" class="link link-hover">Cookie policy</a>
            </nav>
        </footer>
        <footer class="footer bg-base-200 text-base-content border-base-300 border-t px-10 py-4">
            <aside class="grid-flow-col items-center">
                <svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" fill-rule="evenodd"
                    clip-rule="evenodd" class="fill-current">
                    <path
                        d="M22.672 15.226l-2.432.811.841 2.515c.33 1.019-.209 2.127-1.23 2.456-1.15.325-2.148-.321-2.463-1.226l-.84-2.518-5.013 1.677.84 2.517c.391 1.203-.434 2.542-1.831 2.542-.88 0-1.601-.564-1.86-1.314l-.842-2.516-2.431.809c-1.135.328-2.145-.317-2.463-1.229-.329-1.018.211-2.127 1.231-2.456l2.432-.809-1.621-4.823-2.432.808c-1.355.384-2.558-.59-2.558-1.839 0-.817.509-1.582 1.327-1.846l2.433-.809-.842-2.515c-.33-1.02.211-2.129 1.232-2.458 1.02-.329 2.13.209 2.461 1.229l.842 2.515 5.011-1.677-.839-2.517c-.403-1.238.484-2.553 1.843-2.553.819 0 1.585.509 1.85 1.326l.841 2.517 2.431-.81c1.02-.33 2.131.211 2.461 1.229.332 1.018-.21 2.126-1.23 2.456l-2.433.809 1.622 4.823 2.433-.809c1.242-.401 2.557.484 2.557 1.838 0 .819-.51 1.583-1.328 1.847m-8.992-6.428l-5.01 1.675 1.619 4.828 5.011-1.674-1.62-4.829z">
                    </path>
                </svg>
                <p>
                    Devspare.
                    <br />
                    Providing reliable tech since 2024
                </p>
            </aside>
            <nav class="md:place-self-center md:justify-self-end">
                <div class="grid grid-flow-col gap-4">
                    <a>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            class="fill-current">
                            <path
                                d="M24 4.557c-.883.392-1.832.656-2.828.775 1.017-.609 1.798-1.574 2.165-2.724-.951.564-2.005.974-3.127 1.195-.897-.957-2.178-1.555-3.594-1.555-3.179 0-5.515 2.966-4.797 6.045-4.091-.205-7.719-2.165-10.148-5.144-1.29 2.213-.669 5.108 1.523 6.574-.806-.026-1.566-.247-2.229-.616-.054 2.281 1.581 4.415 3.949 4.89-.693.188-1.452.232-2.224.084.626 1.956 2.444 3.379 4.6 3.419-2.07 1.623-4.678 2.348-7.29 2.04 2.179 1.397 4.768 2.212 7.548 2.212 9.142 0 14.307-7.721 13.995-14.646.962-.695 1.797-1.562 2.457-2.549z">
                            </path>
                        </svg>
                    </a>
                    <a>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            class="fill-current">
                            <path
                                d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z">
                            </path>
                        </svg>
                    </a>
                    <a>
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                            class="fill-current">
                            <path
                                d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z">
                            </path>
                        </svg>
                    </a>
                </div>
            </nav>
        </footer>
    </section>




    




<!-- --------------------------------------------------------------- -->





    <!-- Javascript Section -->

    <!-- AOS JS FILE LINK -->
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>

    <script>
        AOS.init();
    </script>

    <script src="js/devspare.js"></script>
<script>

const getPostsData = async () => {
    try {
        const accessToken = localStorage.getItem("accessToken");
        const res = await fetch("http://localhost/devspare/backend/api/v1/articles/article.php", {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${accessToken}`
            }
        });

        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }

        const data = await res.json();
        return data;
    } catch (error) {
        console.error("Error fetching data (Fetch):", error.message);
        return [];
    }
};
const getUserData = async () => {
    try {
        const accessToken = localStorage.getItem("accessToken");
        const res = await fetch("http://localhost/devspare/backend/api/v1/users/get-user.php", {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${accessToken}`
            }
        });
        

        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }

        const data = await res.json();
        return data;
    } catch (error) {
        console.error("Error fetching data (Fetch):", error.message);
        return [];
    }
};

const getUserDataById = async (userId) => {
    try {
        const accessToken = localStorage.getItem("accessToken");
        const res = await fetch(`http://localhost/devspare/backend/api/v1/users/get-user.php?userId=${userId}`, {
            method: 'GET',
            headers: {
                'Authorization': `Bearer ${accessToken}`,
                'Content-Type': 'application/json'
            }
        });

        if (!res.ok) {
            throw new Error(`HTTP error! status: ${res.status}`);
        }

        const data = await res.json();
        return data;
    } catch (error) {
        console.error("Error fetching user data:", error.message);
        return null;
    }
};

// Function to render articles in the DOM
const renderPosts = async () => {
    const data = await getPostsData(); // Fetch posts data
    const postsContainer = document.getElementById("postsContainer");

    if (data.length === 0) {
        postsContainer.innerHTML = "<p>No posts available.</p>";
        return;
    }

    postsContainer.innerHTML = ""; // Clear previous content

    for (const post of data) {
        console.log(post)
        const user = await getUserDataById(post.user_id); // Fetch user data for each post
        console.log(user)

        const postHTML = `
            <a href="/cardDetails.html?id=${post.article_id}" class="block">
                <div class="border-2 lg:p-[40px] p-[28px] border-solid rounded-lg mb-[30px]">
                    <div class="content-items lg:flex justify-between lg:gap-8">
                        <div class="basis-[60%]">
                            <div class="flex mb-[8px] justify-between items-center space-y-2">
                                <div class="flex gap-1 items-center">
                                    <i class="fa-regular fa-circle-user text-[20px]"></i>
                                    <h4 class="lg:text-[24px] text-[14px]">${user?.name || "Anonymous"}</h4>
                                </div>
                                <div>
                                    <button class="btn border bottom-1 lg:px-[10px] px-[6px] py-[0px] lg:py-[1px]">Follow +</button>
                                </div>
                            </div>
                            <h1 class="lg:text-[33px] text-[20px] font-bold">${post.title}</h1>
                            <p class="lg:text-[24px] text-[16px] lg:pb-2 pb-1">${post.content}.slice(0,50)</p>
                            <div class="flex gap-[50px] items-center">
                                <div class="flex gap-1 lg:text-[20px] text-[15px] items-center">
                                    <i class="fa-regular fa-thumbs-up"></i>
                                    <p>${post.like_count || 0}</p>
                                </div>
                                <div class="flex gap-1 lg:text-[20px] text-[15px] items-center">
                                    <i class="fa-regular fa-comment"></i>
                                    <p>${post.comments || 0}</p>
                                </div>
                            </div>
                        </div>
                        <div class="lg:basis-[40%] mt-2">
                            <img class="w-full h-[240px] lg:h-[280px] rounded-lg"
                                src="${post.cover_pic || 'https://via.placeholder.com/300'}"
                                alt="${post.title || 'Post image'}">
                        </div>
                    </div>
                </div>
            </a>
        `;

        postsContainer.innerHTML += postHTML;
    }
};
// Call the render function
renderPosts();
const user = getUserData()
user.then((data) =>
document.getElementById("profile-avatar").querySelector("img").src =
data.profile_pic || "https://via.placeholder.com/150"
)


const renderNotification = async () => {
      const notification = await getAllNotification();
      console.log("notification.length", notification.length);

      // Select the container by ID
      const notificationContainer = document.getElementById("notificationCon");

      document.getElementById("tNotification").innerHTML = `
            <p>${notification.length}</p>
        `;

      // Loop through each notification and render dynamically
      notification.forEach((el) => {
        const notificationDiv = document.createElement("div");
        notificationDiv.classList.add("mt-[70px]");
        notificationDiv.innerHTML = `
          <div class="divider"></div>
          <div>
            <div class="my-[15px] flex items-center gap-[10px]">
              <!-- Image -->
              <img class="rounded-[300px] w-[50px] h-[50px]"
                  src="https://static.vecteezy.com/system/resources/thumbnails/005/346/410/small_2x/close-up-portrait-of-smiling-handsome-young-caucasian-man-face-looking-at-camera-on-isolated-light-gray-studio-background-photo.jpg"
                  alt="">
              <!-- Name part -->
              <div>
                <p class="text-[18px] text-gray-700">${el.title || "title"}</p>
                <p class="text-gray-400 text-[17px]">${el.created_at.toString() || "about 1 year ago"}</p>
              </div>
            </div>
            <!-- Comment -->
            <p class="text-[16px] text-gray-600">${el.message || "Lorem ipsum dolor sit amet consectetur adipisicing elit. Quam, nisi nesciunt beatae quasi sit repudiandae dolorem iste ut consequuntur atque iusto, id odio aliquid eaque, eum est. Odit, dolores earum iure id placeat ratione dignissimos in suscipit laboriosam accusantium eaque?"}</p>
            <div class="divider"></div>
          </div>
        `;
        // Append the rendered notification to the container
        notificationContainer.appendChild(notificationDiv);
      });
    };
    renderNotification()
function removeToken(){
    localStorage.removeItem('accessToken')
}
     
</script>
</body>



</html>